{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Matheesha Weerakoon\\\\Documents\\\\GitHub\\\\spicesense\\\\front-end\\\\src\\\\pages\\\\VerifyEmail.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport { useNavigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst VerifyEmail = () => {\n  _s();\n  const [otp, setOtp] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(\"\");\n  const navigate = useNavigate();\n  const [userId, setUserId] = useState(\"\");\n  useEffect(() => {\n    // Get userId from session storage\n    const storedUserId = sessionStorage.getItem(\"userId\");\n    if (storedUserId) {\n      setUserId(storedUserId);\n    } else {\n      setError(\"User ID not found. Please login again.\");\n    }\n  }, []);\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (!otp.trim()) {\n      setError(\"Please enter the OTP.\");\n      return;\n    }\n    if (!userId) {\n      setError(\"User ID not found. Please login again.\");\n      navigate(\"/login\");\n      return;\n    }\n    setLoading(true);\n    try {\n      const response = await axios.post(\"http://localhost:5000/api/auth/verify-account\", {\n        otp,\n        userId\n      }, {\n        withCredentials: true\n      });\n      console.log(\"Verification response:\", response.data);\n      if (response.data.success) {\n        alert(\"Email verified successfully!\");\n\n        // Store user data in localStorage\n        if (response.data.user) {\n          localStorage.setItem(\"user\", JSON.stringify(response.data.user));\n        }\n\n        // Store token as well\n        if (response.data.token) {\n          localStorage.setItem(\"authToken\", response.data.token);\n        }\n        navigate(\"/dashboard\");\n      } else {\n        setError(response.data.message);\n      }\n    } catch (error) {\n      var _error$response, _error$response$data;\n      console.error(\"Verify OTP error:\", error);\n      let errorMessage = \"An error occurred. Please try again.\";\n      if ((_error$response = error.response) !== null && _error$response !== void 0 && (_error$response$data = _error$response.data) !== null && _error$response$data !== void 0 && _error$response$data.message) {\n        errorMessage = error.response.data.message;\n      } else if (error.message) {\n        errorMessage = error.message;\n      }\n      setError(errorMessage);\n    } finally {\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen flex items-center justify-center bg-gradient-to-b from-amber-50 to-orange-100 p-4\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white rounded-xl shadow-xl p-8 w-full max-w-md\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center mb-8\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-3xl font-bold text-amber-700\",\n          children: \"Verify Your Email\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-600 mt-2\",\n          children: \"Enter the OTP sent to your email\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 9\n      }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit,\n        className: \"space-y-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"otp\",\n            className: \"block text-sm font-medium text-gray-700\",\n            children: \"OTP\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            id: \"otp\",\n            type: \"text\",\n            placeholder: \"Enter your OTP\",\n            value: otp,\n            onChange: e => setOtp(e.target.value.trim()),\n            required: true,\n            className: \"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-amber-500\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 96,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          disabled: loading,\n          className: `w-full py-2 px-4 rounded-md transition-colors ${loading ? \"bg-gray-400 cursor-not-allowed\" : \"bg-amber-600 hover:bg-amber-700 text-white\"}`,\n          children: loading ? \"Verifying...\" : \"Verify\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 78,\n    columnNumber: 5\n  }, this);\n};\n_s(VerifyEmail, \"tkuK/waxaaYz1l4qai9bj57QEMo=\", false, function () {\n  return [useNavigate];\n});\n_c = VerifyEmail;\nexport default VerifyEmail;\nvar _c;\n$RefreshReg$(_c, \"VerifyEmail\");","map":{"version":3,"names":["React","useState","useEffect","axios","useNavigate","jsxDEV","_jsxDEV","VerifyEmail","_s","otp","setOtp","loading","setLoading","error","setError","navigate","userId","setUserId","storedUserId","sessionStorage","getItem","handleSubmit","e","preventDefault","trim","response","post","withCredentials","console","log","data","success","alert","user","localStorage","setItem","JSON","stringify","token","message","_error$response","_error$response$data","errorMessage","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","htmlFor","id","type","placeholder","value","onChange","target","required","disabled","_c","$RefreshReg$"],"sources":["C:/Users/Matheesha Weerakoon/Documents/GitHub/spicesense/front-end/src/pages/VerifyEmail.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport { useNavigate } from \"react-router-dom\";\n\nconst VerifyEmail = () => {\n  const [otp, setOtp] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(\"\");\n  const navigate = useNavigate();\n  const [userId, setUserId] = useState(\"\");\n\n  useEffect(() => {\n    // Get userId from session storage\n    const storedUserId = sessionStorage.getItem(\"userId\");\n    if (storedUserId) {\n      setUserId(storedUserId);\n    } else {\n      setError(\"User ID not found. Please login again.\");\n    }\n  }, []);\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    if (!otp.trim()) {\n      setError(\"Please enter the OTP.\");\n      return;\n    }\n\n    if (!userId) {\n      setError(\"User ID not found. Please login again.\");\n      navigate(\"/login\");\n      return;\n    }\n\n    setLoading(true);\n    try {\n      const response = await axios.post(\n        \"http://localhost:5000/api/auth/verify-account\",\n        { otp, userId },\n        { withCredentials: true }\n      );\n\n      console.log(\"Verification response:\", response.data);\n\n      if (response.data.success) {\n        alert(\"Email verified successfully!\");\n\n        // Store user data in localStorage\n        if (response.data.user) {\n          localStorage.setItem(\"user\", JSON.stringify(response.data.user));\n        }\n\n        // Store token as well\n        if (response.data.token) {\n          localStorage.setItem(\"authToken\", response.data.token);\n        }\n\n        navigate(\"/dashboard\");\n      } else {\n        setError(response.data.message);\n      }\n    } catch (error) {\n      console.error(\"Verify OTP error:\", error);\n      let errorMessage = \"An error occurred. Please try again.\";\n      if (error.response?.data?.message) {\n        errorMessage = error.response.data.message;\n      } else if (error.message) {\n        errorMessage = error.message;\n      }\n      setError(errorMessage);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-b from-amber-50 to-orange-100 p-4\">\n      <div className=\"bg-white rounded-xl shadow-xl p-8 w-full max-w-md\">\n        <div className=\"text-center mb-8\">\n          <h1 className=\"text-3xl font-bold text-amber-700\">Verify Your Email</h1>\n          <p className=\"text-gray-600 mt-2\">Enter the OTP sent to your email</p>\n        </div>\n\n        {error && (\n          <div className=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4\">\n            {error}\n          </div>\n        )}\n\n        <form onSubmit={handleSubmit} className=\"space-y-6\">\n          <div className=\"space-y-2\">\n            <label htmlFor=\"otp\" className=\"block text-sm font-medium text-gray-700\">\n              OTP\n            </label>\n            <input\n              id=\"otp\"\n              type=\"text\"\n              placeholder=\"Enter your OTP\"\n              value={otp}\n              onChange={(e) => setOtp(e.target.value.trim())}\n              required\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-amber-500\"\n            />\n          </div>\n          <button\n            type=\"submit\"\n            disabled={loading}\n            className={`w-full py-2 px-4 rounded-md transition-colors ${\n              loading ? \"bg-gray-400 cursor-not-allowed\" : \"bg-amber-600 hover:bg-amber-700 text-white\"\n            }`}\n          >\n            {loading ? \"Verifying...\" : \"Verify\"}\n          </button>\n        </form>\n      </div>\n    </div>\n  );\n};\n\nexport default VerifyEmail;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}